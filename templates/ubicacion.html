<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    />
    <link
      rel="icon"
      href="https://vineethtr.000webhostapp.com/wp-content/uploads/2018/01/logo.png"
      sizes="192x192"
    />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link
      rel="apple-touch-icon-precomposed"
      href="https://vineethtr.000webhostapp.com/wp-content/uploads/2018/01/logo.png"
    />
    <meta
      name="msapplication-TileImage"
      content="https://vineethtr.000webhostapp.com/wp-content/uploads/2018/01/logo.png"
    />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>C&E - Ubicación</title>

    <script type="text/javascript">
      // Redirección rápida basada en el userAgent
      (function () {
        if (!/Mobi|Tablet|iPad|Android/i.test(navigator.userAgent)) {
          // El usuario está usando una PC
          window.location.href = "/pc";
        }
      })();
    </script>
    <!-- Bootstrap -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
      integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
      crossorigin="anonymous"
    />

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style media="screen">
      .no-select {
        -webkit-user-select: none; /* Chrome, Safari, Opera */
        -moz-user-select: none; /* Firefox */
        -ms-user-select: none; /* Internet Explorer/Edge */
        user-select: none; /* Non-prefixed version, currently supported by Chrome, Edge, Opera and Firefox */
      }

      * {
        margin: 0;
        padding: 0;
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
      }

      a {
        color: #03658c;
        text-decoration: none;
      }

      ul {
        list-style-type: none;
      }

      body {
        font-family: "Montserrat", Arial, Helvetica, Sans-serif, Verdana;
        background-image: url('/static/images/fondo-ubicacion.png');
            background-size: 100% 100%; /* Estira la imagen para cubrir el ancho y alto completos */
            background-repeat: no-repeat;
            background-attachment: fixed; /* Opcional, para que la imagen no se desplace con el contenido */
            margin: 0;
            padding: 0;
            overflow: hidden; /* Evita desbordamientos accidentales */
      }
      .header {
        text-align: center;
        margin-top: 60px;
      }
      .titulo{
        text-transform: uppercase;
        font-weight: 700;
        font-size: 2.5rem;
        letter-spacing: 0.2rem;
        color: #1c1a1a;
        
      }
      .cards{
        display: flex;
        width: 100%;
        height: 60rem;
        padding-top: 23%;
        flex-direction: column;
        gap: 60px;
        padding-left: 6px;

      }
      .cards-title{
        text-transform: uppercase;
        font-size: 26px;
        padding-left: 16px;
      }
      .cards-description{
        display: flex;
        height: 100%;
        align-items: center;
        justify-content: space-around;
        margin-top: 10px;
        
      }
      .card-description-text{
        text-transform: uppercase;
        font-size: 19px;
        letter-spacing: 0.2rem;
      }
      .card-description-button{
        width: 10%;
        height: 40px;
        border-radius: 5px;
        background: #9f2c33;
        color: white;
        font-size: small;
      }
      .tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-10px);
            background-color: rgba(208, 134, 134);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8rem;
            display: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            opacity: 0;
            transition: opacity 0.5s ease;
            animation: bounce 1s ease;
            width: auto !important;
        }
        .tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: rgba(208, 134, 134) transparent transparent transparent;
        }
        #loadingSpinner {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, .95);
        z-index: 2000;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .loader {
        border: 6px solid #f3f3f3; /* Light grey */
        border-top: 6px solid #9f2c33; 
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 2s linear infinite;
    }
    

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
   

      /** =====================
 * Responsive
 ========================*/
      @media only screen and (max-width: 766px) {
        .comments-container {
          width: 100%;
        }

        .comments-list .comment-box {
          width: 100%;
        }

        .reply-list .comment-box {
          width: 100%;
        }
      }

      
      #swal2-input:focus {
        outline: none; /* Elimina el borde por defecto */
        border-color: #9f2c33; /* Cambia el color del borde al enfocar */
        box-shadow: 0 0 5px rgba(208, 134, 134, 0.575); /* Añade una sombra de color*/
      }
    </style>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/ScrollTrigger.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css?family=Material+Icons|Material+Icons+Outlined|Material+Icons+Two+Tone|Material+Icons+Round|Material+Icons+Sharp"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@latest"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/toastr/build/toastr.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/toastr/build/toastr.min.js"></script>
    <meta name="google" content="notranslate" />
    <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
  </head>

  <body style="background-color: black; overflow: hidden !important">
    <div>
      <div class="header">
        <h1 class="titulo">Ubicación</h1>
      </div>
      <div class="cards">
        <div class="card-item">
          <h2 class="cards-title">
            <img src="../static/images/iglesia.png" alt="" style="width: 40px; padding-bottom: 5px;">
          Iglesia</h2>
          <div class="cards-description">
            <p class="card-description-text">Catedral San Rafael</p>
            <button class="card-description-button" id="locationButtonIglesia" >Ir</button>
          </div>
        </div>
        <div class="card-item">
          <h2 class="cards-title">
            <img src="../static/images/anillo.png" alt="" style="width: 45px; margin-right: -5px;">
            Salon</h2>
          <div class="cards-description">
            <p class="card-description-text">Salón el Mangrullo</p>
            <button class="card-description-button" id="locationButton">Ir</button>
          </div>
        </div>
      </div>
    </div>
   
       <!-- MENU -->
       <div class="card" style="position: fixed; bottom: 0px; padding: 1rem; width: 100%;">
        <div class="row" style="justify-content: space-evenly;">
            <div class="col-2 d-flex justify-content-center" style="text-align: center;" id="homeButton" onclick="showHome()" >
                <div style="position: relative; width: 50px; height: 50px; display: flex; justify-content: center; padding-top:.7rem;">
                    <span class="material-symbols-outlined no-select" style="font-size: 2.7rem; color:#9f2c33;">home</span>
                    <div class="tooltip" style="width:4.3rem !important;">Busca info sobre el evento.
                        <div class="tooltip-arrow"></div>
                    </div>
                </div>
            </div>
            <div class="col-2 d-flex justify-content-center" style="text-align: center;" id="locationButton" onclick="showLocation()">
                <div style="position: relative; width: 50px; height: 50px; display: flex; justify-content: center; padding-top:.7rem">
                    <span class="material-symbols-outlined no-select" style="font-size: 2.7rem; color:#9f2c33">map</span>
                    <div class="tooltip">Abrí la Ubicación del salon<div class="tooltip-arrow"></div>
                </div>
            </div>
        </div>
        <div class="col-2 d-flex justify-content-center" style="text-align: center;" data-bs-toggle="modal" data-bs-target="#donationModal" onclick="showGifts()">
            <div style="position: relative; width: 50px; height: 50px;display: flex;justify-content: center; padding-top:.7rem">
                <span class="material-symbols-outlined no-select" style="font-size: 2.7rem; color:#9f2c33">featured_seasonal_and_gifts</span>
                <div class="tooltip" style="width:7rem !important">Envianos $$ <i class="material-symbols-outlined no-select float-end" style="font-size:.9rem; margin-top:.2rem">sentiment_very_satisfied</i>
                    <div class="tooltip-arrow"></div>
                </div>
            </div>
        </div>
        <div class="col-2 d-flex justify-content-center" style="text-align: center;" id="galery" onclick="showGallery()">
            <div style="position: relative; width: 50px; height: 50px; display: flex; justify-content: center; padding-top:.7rem">
                <span class="material-symbols-outlined no-select" style="font-size: 2.7rem; color:#9f2c33">photo_library</span>
                <div class="tooltip" style="width:5rem !important">Mira todas las fotos.
                    <div class="tooltip-arrow"></div>
                </div>
            </div>
        </div>
    <!--         <div class="col-2 d-flex justify-content-center" style="text-align: center;" id="locationButtonIglesia">
                <div style="position: relative; width: 50px; height: 50px;display:flex;justify-content: center; padding-top:.7rem">
                    <span class="material-symbols-outlined no-select" style="font-size: 1.7rem; color:#9f2c33">church</span>
                    <div class="tooltip" style="width:6rem !important">Abrí la Ubicacion de la iglesia
                        <div class="tooltip-arrow"></div>
                    </div>
                </div>
            </div> -->
            <div class="col-2 d-flex justify-content-center" style="text-align: center; cursor: pointer;" id="uploadTrigger">
                <div style="position: relative;background-color:#9f2c33; width: 45px; height: 45px; border-radius: 10%; display: flex; justify-content: center; align-items: center;box-shadow: rgba(0, 0, 0, 0.07) 0px 1px 2px, rgba(0, 0, 0, 0.07) 0px 2px 4px, rgba(0, 0, 0, 0.07) 0px 4px 8px, rgba(0, 0, 0, 0.07) 0px 8px 16px, rgba(0, 0, 0, 0.07) 0px 16px 32px, rgba(0, 0, 0, 0.07) 0px 32px 64px;">
                    <span class="material-symbols-outlined no-select" style="font-size: 2.5rem; color: white;">add_a_photo</span>
                    <div class="tooltip">Subí tu foto al evento!
                        <div class="tooltip-arrow"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
   <!-- Input para seleccionar la imagen -->
   <input type="file" id="fileInput" accept="image/*" capture="camera" style="display: none;">
   <!-- Modal de Previsualización -->
    <div id="previewModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1050; justify-content: center; align-items: center;">
       <div style="position: relative; padding: 20px; max-width: 90%; max-height: 90%; width: auto; height: auto;">
          <center><img id="preview" src="#" alt="Image Preview" style="width: auto; height: 50vh !important; border-radius: 8px;max-width: 70vw;"></center> 
           <div class="row">
               <div class="col-12 d-flex justify-content-center">
                   <button class="btn btn-sm btn-secondary" onclick="closePreview()" style="display:inline-flex;">Cerrar</button>
                   <button class="btn btn-sm btn-secondary" onclick="retryUpload()" style="display:inline-flex;">Tomar otra foto</button>
               <button class="btn btn-sm btn-danger"  onclick="submitImage()">Subir</button>
               <span style="position:fixed; color:white; top:5vh; width:70%; font-size: .8rem;">
                  <center>Nota: Esta es una previsualización. Al subirse, la imagen conservará su aspecto original.</center> 
               </span>
           </div>        
       </div>
   </div>
    
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script
      src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"
      integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>

  <script>
    function showGallery() {
     window.location.href = '/galery';
}
function showGifts(){
    window.location.href = '/regalos';
}
function showLocation(){
    window.location.href = '/ubicacion';
}
function showHome(){
    window.location.href = '/';
}

function showSpinner() {
    document.getElementById('loadingSpinner').style.display = 'flex';
}

function hideSpinner() {
    document.getElementById('loadingSpinner').style.display = 'none';
}

   document.getElementById('uploadTrigger').onclick = function() {
            document.getElementById('fileInput').click();
        };
        document.getElementById('fileInput').onchange = function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('preview').src = e.target.result;
                    document.getElementById('previewModal').style.display = 'flex';
                };
                reader.readAsDataURL(file);
            }
        };
        function closePreview() {
            document.getElementById('previewModal').style.display = 'none';
        }
        function retryUpload() {
            document.getElementById('fileInput').click();
        }

function submitImage() {
    var fileInput = document.getElementById('fileInput');
    if (fileInput.files.length > 0) {
        const file = fileInput.files[0];
        showSpinner();
        uploadImage(file);
    }
}

function uploadImage(file) {
    const formData = new FormData();
    formData.append('file', file);

    const xhr = new XMLHttpRequest();
    xhr.open('POST', '/upload', true);
    xhr.upload.onprogress = function(e) {
        if (e.lengthComputable) {
            const percentComplete = Math.round((e.loaded / e.total) * 100);
            console.log(percentComplete + '% uploaded');
        }
    };
    xhr.onload = function() {
         hideSpinner(); 
        if (xhr.status === 200) {
            Swal.fire({
                icon: 'success',
                title: '¡Subido con éxito!',
                text: 'Tu foto ha sido subida correctamente.'
            });
        } else {
            Swal.fire({
                icon: 'error',
                title: 'Error al subir',
                text: 'Hubo un problema al subir tu foto.'
            });
        }
        document.getElementById('previewModal').style.display = 'none';
    };
    xhr.send(formData);
}
     fetch('/api/config')
        .then(response => response.json())
        .then(config => {
            if (config) {
                // Configurar la ubicación desde la base de datos
                //codigo comentado por Ciro
                document.getElementById('locationButton').onclick = function() {
                    window.open(`https://www.google.com/maps?q=${config.eventoCoordX},${config.eventoCoordY}`, '_blank');
                };
                document.getElementById('locationButtonIglesia').onclick = function() {
                    window.open(`https://www.google.com/maps?q=${config.iglesiaCoordX},${config.iglesiaCoordY}`, '_blank');
                }; 
                //configuracion de modales
  


            }
        })
    
    function checkOrientation() {
      if (window.innerWidth > window.innerHeight) {
        document.getElementById("landscape-overlay").style.display = "block";
        document.getElementById("content").style.display = "none";
      } else {
        document.getElementById("landscape-overlay").style.display = "none";
        document.getElementById("content").style.display = "block";
      }
    }

    window.addEventListener("resize", checkOrientation);
    window.addEventListener("load", checkOrientation);
    window.addEventListener("orientationchange", checkOrientation);
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</html>
